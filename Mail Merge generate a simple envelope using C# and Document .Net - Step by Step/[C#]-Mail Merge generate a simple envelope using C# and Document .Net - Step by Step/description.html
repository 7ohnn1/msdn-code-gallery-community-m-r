<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Header,0:HeaderFooterSprite,0:Header.NonMtps;/Areas/Centers/Themes/StandardDevCenter/Content:0&amp;amp;v=FD9DC8A8E60F195E257BA9BDD8F22730" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Footer,0:HeaderFooterSprite,0:Footer.NonMtps,1:NewFooterSock,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;v=A7AC825C25AAC42BB50FA54C02B39551" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Mail Merge: generate a simple envelope using C# and Document .Net - Step by Step</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="https://i1.code.msdn.s-msft.com/content/common/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="https://i1.code.msdn.s-msft.com/content/common/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Mail Merge: generate a simple envelope using C# and Document .Net - Step by Step</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            C#, ASP.NET, .NET Framework
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Controls, Graphics, C#, ASP.NET, User Interface, How to, Office 2010 101 code samples
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop, Web
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">10/28/2016</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MS-LPL</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="https://code.msdn.microsoft.com/Mail-Merge-generate-a-5d79937c">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Introduction</h1>
<p class="CommonText">Mail Merge is the feature of Document .Net which allows to easy generate documents (reports, letters, envelopes) using templates. For example, it's will be very helpful to generate hundreds of identical documents but with different data.</p>
<p class="CommonText">To illustrate how works Mail Merge function let's create C# application which generates envelopes &quot;Happy New Year&quot;' for Simpson family. As result, we'll get 5 (five) same congratulatory envelopes in the single document.</p>
<h1><span>Our Steps:</span></h1>
<ol class="CommonText">
<li>Create an envelope template (envelope-template.docx) in MS Word with Fields &quot;Name&quot; and &quot;FamilyName&quot;.
</li><li>Type C# code which executes Mail Merge between Simpson persons and &quot;envelope-template.docx&quot;.
</li><li>See result: &quot;simpson-family.docx: which contains 5 (five) named envelopes. </li></ol>
<p><span style="font-size:20px; font-weight:bold">Description</span></p>
<h2 class="H2Text">1. Create an envelope template in MS Word:&nbsp;<span class="CommonText">envelope-template.docx</span></h2>
<p class="CommonText">To start, let's open MS Word and create new empty document with name &quot;envelope-template.docx&quot;. Next, you may add some images and text, anything what you want to see to gongratulate the Simpson's family. Our main goal is add two&nbsp;<strong>Fields</strong>&nbsp;&quot;Name&quot;
 and &quot;FamilyName&quot;.</p>
<ol class="CommonText">
<li>Select &quot;INSERT&quot; tab. </li><li>Click by the pictogram &quot;Quick Parts&quot;. </li><li>Select and click by &quot;Field..&quot; menu item. </li><li>In the opened window, follow to the &quot;Field names:&quot; and select &quot;MergeField&quot;. </li><li>In the &quot;Field name:&quot; type &quot;Name&quot;. </li><li>Click &quot;OK&quot; </li></ol>
<p><span>By the same steps, please add another Field with name &quot;FamilyName&quot;.</span></p>
<p><img id="162799" src="description/envelope-create-template.jpg" alt="" width="800" height="429"></p>
<p><span class="CommonText"><br>
</span></p>
<p><em>&nbsp;</em></p>
<h2 class="H2Text">2. C# code which executes Mail Merge between Simpson persons and &quot;envelope-template.docx&quot;</h2>
<p>&nbsp;</p>
<p>&nbsp;</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">DocumentCore dc = DocumentCore.Load(@&quot;envelope-template.docx&quot;);

var dataSource = new[] { new { Name = &quot;Homer&quot;, FamilyName = &quot;Simpson&quot; }, 
                    new { Name = &quot;Marge &quot;, FamilyName = &quot;Simpson&quot; },
                    new { Name = &quot;Bart&quot;, FamilyName = &quot;Simpson&quot; },
                    new { Name = &quot;Lisa&quot;, FamilyName = &quot;Simpson&quot; },
                    new { Name = &quot;Maggie&quot;, FamilyName = &quot;Simpson&quot; }};

dc.MailMerge.Execute(dataSource);
dc.Save(@&quot;Simpson-family.docx&quot;);</pre>
<div class="preview">
<pre class="csharp">DocumentCore&nbsp;dc&nbsp;=&nbsp;DocumentCore.Load(@<span class="cs__string">&quot;envelope-template.docx&quot;</span>);&nbsp;
&nbsp;
var&nbsp;dataSource&nbsp;=&nbsp;<span class="cs__keyword">new</span>[]&nbsp;{&nbsp;<span class="cs__keyword">new</span>&nbsp;{&nbsp;Name&nbsp;=&nbsp;<span class="cs__string">&quot;Homer&quot;</span>,&nbsp;FamilyName&nbsp;=&nbsp;<span class="cs__string">&quot;Simpson&quot;</span>&nbsp;},&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">new</span>&nbsp;{&nbsp;Name&nbsp;=&nbsp;<span class="cs__string">&quot;Marge&nbsp;&quot;</span>,&nbsp;FamilyName&nbsp;=&nbsp;<span class="cs__string">&quot;Simpson&quot;</span>&nbsp;},&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">new</span>&nbsp;{&nbsp;Name&nbsp;=&nbsp;<span class="cs__string">&quot;Bart&quot;</span>,&nbsp;FamilyName&nbsp;=&nbsp;<span class="cs__string">&quot;Simpson&quot;</span>&nbsp;},&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">new</span>&nbsp;{&nbsp;Name&nbsp;=&nbsp;<span class="cs__string">&quot;Lisa&quot;</span>,&nbsp;FamilyName&nbsp;=&nbsp;<span class="cs__string">&quot;Simpson&quot;</span>&nbsp;},&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">new</span>&nbsp;{&nbsp;Name&nbsp;=&nbsp;<span class="cs__string">&quot;Maggie&quot;</span>,&nbsp;FamilyName&nbsp;=&nbsp;<span class="cs__string">&quot;Simpson&quot;</span>&nbsp;}};&nbsp;
&nbsp;
dc.MailMerge.Execute(dataSource);&nbsp;
dc.Save(@<span class="cs__string">&quot;Simpson-family.docx&quot;</span>);</pre>
</div>
</div>
</div>
<p><span>Here we create an array of objects by anonymous type. After execution of mail merge method we'll get the same number of copies document with filled fields as number of objects in the array.</span></p>
<h2 class="H2Text">3. See result: &quot;simpson-family.docx&quot;</h2>
<p><span><img id="162800" src="description/envelope-result.png" alt=""><br>
</span></p>
<h1>Source Code Files</h1>
<div><em>Related Links:</em></div>
<div><em><br>
Website:&nbsp;<a href="http://www.sautinsoft.com/">www.sautinsoft.com</a><br>
Product Home:&nbsp;<a href="http://sautinsoft.com/products/document/index.php">Document.Net</a><br>
Download:&nbsp;<em><a href="http://sautinsoft.com/thankyou.php?download=document_net.zip">Document.Net</a></em><br>
</em></div>
<h2 class="H2Text">Requrements and Technical Information</h2>
<p class="CommonText"><span>&nbsp;Requires only .Net 4.0 or above. Our product is compatible with all .Net languages and supports all Operating Systems where .Net Framework can be used.</span><br>
<br>
<span>Note that &laquo;Document .Net&raquo; is entirely written in managed C#, which makes it absolutely standalone and an independent library. Of course, No dependency on Microsoft Word.</span></p>

</div>


    </div>
</body>
</html>
