<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=62DBC035A4A8AD76676CA11B61CB6C59" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/2b95a022-1a2d-4518-9190-b20e3172358eCombined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=60546B18CCC226DE9D7A404EDD74623E" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Practical Asynchronous Programming for VS2012 or higher</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Practical Asynchronous Programming for VS2012 or higher</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            C#, User Interface, Multithreading, Data Access, threading, Visual Basic.NET, DataGridView, Async, Task Parallel Library, Visual Studio 2012
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Asynchronous Programming, User Interface, Windows Forms, Data Access, How to
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Data
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">8/12/2014</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/Practical-Asynchronous-ebd00ae1">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1><span style="font-size:20px; font-weight:bold">Description</span></h1>
<p><span style="font-size:small">This article provides practical examples in C# and VB.NET to use Task-based Asynchronous Pattern (TAP) available beginning with Visual Studio 2012. There is a good deal of information out there already on TAP so rather than
 repeat this do a search on the web, for examples they are not practical to the developer who wants to load large amounts of data while keeping the user interface responsive along with providing the capability to cancel these operations. The most common examples
 are downloading something from a web site which I have never needed this in any of my solutions and would guess the majority of developers are the same.</span></p>
<p><span style="font-size:small">Practical examples are those that read data using a managed data provider such as OleDb or SqlClient for instance simply because most developers are working SQL-Server or MS-Access. Of course there are others such as MySQL where
 these should have methods to accomplish what I am doing in these examples.</span></p>
<p><br>
<span style="font-size:small">There are two projects, one in C# and one in VB.NET which share a C# backend class project to access data using TAP. Another VB.NET forms project which uses the same logic as done in the prior projects but without a class project
 yet that can be done too. There is a VB.NET example for reading data in a splash screen which depends on delegates in the splash form plus using a Iterator function (returning data via Yield) to retrieve data using synchronous data access yet the splash screen
 stays responsive as all splash screens run in a separate thread then the main form.</span></p>
<p><span style="font-size:small">Rather than getting into each piece I believe you can run the projects, see what they do then go back and review the code to learn from. When running a demo project make sure to move the form around to see that it does response,
 press cancel to see what happens too.</span></p>
<p><span style="font-size:small">Note: I have used Thread.Sleep in several parts of the solution. For your projects please use the following. See a demostration of Sleep vs. Delay see&nbsp;<a href="http://code.msdn.microsoft.com/ThreadSleep-vs-TaskDelay-766b46b7">Thread.Sleep
 vs.Task.Delay</a> which has a examples of both in C#, same holds true for VB.NET.</span></p>
<p><span style="font-size:small">&nbsp;</span></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">await Task.Delay(n, tokenSource.Token);</pre>
<div class="preview">
<pre class="csharp">await&nbsp;Task.Delay(n,&nbsp;tokenSource.Token);</pre>
</div>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-size:small">Lastly, I keep things basic so you can learn from these projects so keep that in mind. If there is something missing then once you understand the code tweak it, make the code yours.<br>
<br>
<img id="122375" src="description/11PM.png" alt="" width="439" height="465"></span></p>
<p>&nbsp;</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>Visual Basic</span><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">vb</span><span class="hidden">csharp</span>
<pre class="hidden">Imports <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Threading.aspx"  title="Auto generated link to System.Threading">System.Threading</a>
Imports <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Data.Common.aspx"  title="Auto generated link to System.Data.Common">System.Data.Common</a>

Public Class DataOperations
    Private Builder As New OleDb.OleDbConnectionStringBuilder
    Private theToken As New CancellationTokenSource

    ''' &lt;summary&gt;
    ''' Record count for Customers table
    ''' &lt;/summary&gt;
    ''' &lt;value&gt;&lt;/value&gt;
    ''' &lt;returns&gt;&lt;/returns&gt;
    ''' &lt;remarks&gt;&lt;/remarks&gt;
    Public Property RecordCount As Integer
    ''' &lt;summary&gt;
    ''' Used for cancel operations
    ''' &lt;/summary&gt;
    ''' &lt;value&gt;&lt;/value&gt;
    ''' &lt;returns&gt;&lt;/returns&gt;
    ''' &lt;remarks&gt;&lt;/remarks&gt;
    Public Property Token As CancellationToken
    ''' &lt;summary&gt;
    ''' DataTable containing customer data
    ''' &lt;/summary&gt;
    ''' &lt;value&gt;&lt;/value&gt;
    ''' &lt;returns&gt;&lt;/returns&gt;
    ''' &lt;remarks&gt;&lt;/remarks&gt;
    Public Property DataTable As DataTable
    ''' &lt;summary&gt;
    ''' Calling for used for invoke
    ''' &lt;/summary&gt;
    ''' &lt;value&gt;&lt;/value&gt;
    ''' &lt;returns&gt;&lt;/returns&gt;
    ''' &lt;remarks&gt;&lt;/remarks&gt;
    Public Property Caller As Form
    ''' &lt;summary&gt;
    ''' Label to show status while running
    ''' &lt;/summary&gt;
    ''' &lt;value&gt;&lt;/value&gt;
    ''' &lt;returns&gt;&lt;/returns&gt;
    ''' &lt;remarks&gt;&lt;/remarks&gt;
    Public Property Label As Label

    Public Sub New()
        DataTable = New DataTable With {.TableName = &quot;Customers&quot;}
        DataTable.Columns.Add(New DataColumn With {.ColumnName = &quot;Identifier&quot;, .DataType = GetType(Int32)})
        DataTable.Columns.Add(New DataColumn With {.ColumnName = &quot;CompanyName&quot;, .DataType = GetType(String)})
        DataTable.Columns.Add(New DataColumn With {.ColumnName = &quot;ContactName&quot;, .DataType = GetType(String)})
        DataTable.Columns.Add(New DataColumn With {.ColumnName = &quot;ContactTitle&quot;, .DataType = GetType(String)})
        DataTable.Columns.Add(New DataColumn With {.ColumnName = &quot;Country&quot;, .DataType = GetType(String)})

        Builder.Provider = &quot;Microsoft.ACE.OLEDB.12.0&quot;
        Builder.DataSource = IO.Path.Combine(AppDomain.CurrentDomain.BaseDirectory, &quot;Customers.accdb&quot;)

        GetRecordCount()
    End Sub
    ''' &lt;summary&gt;
    ''' Code to get data
    ''' &lt;/summary&gt;
    ''' &lt;param name=&quot;ct&quot;&gt;&lt;/param&gt;
    ''' &lt;returns&gt;&lt;/returns&gt;
    ''' &lt;remarks&gt;&lt;/remarks&gt;
    Public Async Function GetDataAsync(ByVal ct As CancellationToken) As Task
        Dim CurrentRecord As Integer = 1

        Using cn As New OleDbConnection(Builder.ConnectionString)
            Using cmd As New OleDbCommand(
                &quot;SELECT Identifier, CompanyName, ContactName, ContactTitle, Country FROM Customers&quot;, cn)

                Await cn.OpenAsync()

                Using reader As DbDataReader = Await cmd.ExecuteReaderAsync()
                    Do While Await reader.ReadAsync()
                        If ct.IsCancellationRequested Then
                            Exit Do
                        End If

                        Dim PrimaryKey As Integer = Await reader.GetFieldValueAsync(Of Integer)(0)

                        Dim ItemArray() As Object =
                            {
                                PrimaryKey,
                                Await reader.GetFieldValueAsync(Of String)(1),
                                Await reader.GetFieldValueAsync(Of String)(2),
                                Await reader.GetFieldValueAsync(Of String)(3),
                                Await reader.GetFieldValueAsync(Of String)(4)
                            }

                        Caller.Invoke(
                            New EventHandler(
                                Sub(sender As Object, e As EventArgs)
                                    DataTable.Rows.Add(ItemArray)
                                    If Label IsNot Nothing Then
                                        If Not Label.InvokeRequired Then
                                            Label.Text = String.Format(&quot;{0} of {1}&quot;, CurrentRecord, Me.RecordCount)
                                        End If
                                    End If
                                End Sub), New Object(1) {ItemArray, Nothing})

                        CurrentRecord &#43;= 1

                        '
                        ' Beings we only have a small set of records we will do a delay
                        '
                        Thread.Sleep(1000)

                    Loop
                End Using
            End Using
        End Using
    End Function
    ''' &lt;summary&gt;
    ''' Get record count in Customers table
    ''' &lt;/summary&gt;
    ''' &lt;remarks&gt;&lt;/remarks&gt;
    Private Sub GetRecordCount()
        Using cn As New OleDbConnection(Builder.ConnectionString)
            Using cmd As New OleDbCommand(&quot;SELECT Count(Identifier) FROM Customers;&quot;, cn)
                cn.Open()
                RecordCount = CInt(Fix(cmd.ExecuteScalar()))
            End Using
        End Using
    End Sub
End Class
</pre>
<pre class="hidden">using System;
using <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Data.aspx"  title="Auto generated link to System.Data">System.Data</a>;
using <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Data.Common.aspx"  title="Auto generated link to System.Data.Common">System.Data.Common</a>;
using <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Data.OleDb.aspx"  title="Auto generated link to System.Data.OleDb">System.Data.OleDb</a>;
using <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.IO.aspx"  title="Auto generated link to System.IO">System.IO</a>;
using <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Threading.aspx"  title="Auto generated link to System.Threading">System.Threading</a>;
using <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Threading.Tasks.aspx"  title="Auto generated link to System.Threading.Tasks">System.Threading.Tasks</a>;
using <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Windows.Forms.aspx"  title="Auto generated link to System.Windows.Forms">System.Windows.Forms</a>;

namespace DataOperations
{
    public class Work
    {
        private OleDbConnectionStringBuilder Builder = new OleDbConnectionStringBuilder();
        private CancellationTokenSource cts = new CancellationTokenSource();

        public int RecordCount { get; set; }

        public CancellationToken Token { get; set; }

        public DataTable dtPeople { get; set; }

        /// &lt;summary&gt;
        /// Form who called us
        /// &lt;/summary&gt;
        public Form Caller { get; set; }

        /// &lt;summary&gt;
        /// Label to show how many rows are processed
        /// &lt;/summary&gt;
        public Label Label { get; set; }

        public Work()
        {
            dtPeople = new DataTable { TableName = &quot;PeopleTable&quot; };
            dtPeople.Columns.Add(new DataColumn { ColumnName = &quot;Identifier&quot;, DataType = typeof(Int32) });
            dtPeople.Columns.Add(new DataColumn { ColumnName = &quot;FirstName&quot;, DataType = typeof(string) });
            dtPeople.Columns.Add(new DataColumn { ColumnName = &quot;LastName&quot;, DataType = typeof(string) });

            Builder.Provider = &quot;Microsoft.ACE.OLEDB.12.0&quot;;
            Builder.DataSource = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, &quot;PeopleDatabase.accdb&quot;);

            GetRecordCount();
        }

        public async Task GetDataAsync(CancellationToken ct)
        {
            int CurrentRecord = 0;

            using (OleDbConnection cn = new OleDbConnection(Builder.ConnectionString))
            {
                using (OleDbCommand cmd = new OleDbCommand(&quot;SELECT Identifier, FirstName, LastName FROM People;&quot;, cn))
                {
                    await cn.OpenAsync();
                    using (DbDataReader reader = await cmd.ExecuteReaderAsync())
                    {
                        while (await reader.ReadAsync())
                        {
                            if (ct.IsCancellationRequested)
                            {
                                break;
                            }

                            int PrimaryKey = await reader.GetFieldValueAsync&lt;int&gt;(0);

                            Object[] ItemArray =
                            {
                                PrimaryKey,
                                await reader.GetFieldValueAsync&lt;string&gt;(1),
                                await reader.GetFieldValueAsync&lt;string&gt;(2)
                            };

                            Caller.Invoke(new EventHandler(delegate(object sender, EventArgs e)
                                {
                                    dtPeople.Rows.Add(ItemArray);

                                    if (Label != null)
                                    {
                                        if (Label.InvokeRequired == false)
                                        {
                                            Label.Text = string.Format(&quot;{0} of {1}&quot;, CurrentRecord, this.RecordCount);
                                        }
                                    }
                                }), new object[2] { ItemArray, null }
                            );

                            CurrentRecord &#43;= 1;
                        }
                    }
                }
            }
        }

        private void GetRecordCount()
        {
            using (OleDbConnection cn = new OleDbConnection(Builder.ConnectionString))
            {
                using (OleDbCommand cmd = new OleDbCommand(&quot;SELECT Count(Identifier) FROM People;&quot;, cn))
                {
                    cn.Open();
                    RecordCount = (int)cmd.ExecuteScalar();
                }
            }
        }
    }
}</pre>
<div class="preview">
<pre class="js">Imports&nbsp;System.Threading&nbsp;
Imports&nbsp;System.Data.Common&nbsp;
&nbsp;
Public&nbsp;Class&nbsp;DataOperations&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Private&nbsp;Builder&nbsp;As&nbsp;New&nbsp;OleDb.OleDbConnectionStringBuilder&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Private&nbsp;theToken&nbsp;As&nbsp;New&nbsp;CancellationTokenSource&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;summary&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;Record&nbsp;count&nbsp;<span class="js__statement">for</span>&nbsp;Customers&nbsp;table&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;/summary&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;value&gt;&lt;/value&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;returns&gt;&lt;/returns&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;remarks&gt;&lt;/remarks&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;Property&nbsp;RecordCount&nbsp;As&nbsp;Integer&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;summary&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;Used&nbsp;<span class="js__statement">for</span>&nbsp;cancel&nbsp;operations&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;/summary&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;value&gt;&lt;/value&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;returns&gt;&lt;/returns&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;remarks&gt;&lt;/remarks&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;Property&nbsp;Token&nbsp;As&nbsp;CancellationToken&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;summary&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;DataTable&nbsp;containing&nbsp;customer&nbsp;data&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;/summary&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;value&gt;&lt;/value&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;returns&gt;&lt;/returns&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;remarks&gt;&lt;/remarks&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;Property&nbsp;DataTable&nbsp;As&nbsp;DataTable&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;summary&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;Calling&nbsp;<span class="js__statement">for</span>&nbsp;used&nbsp;<span class="js__statement">for</span>&nbsp;invoke&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;/summary&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;value&gt;&lt;/value&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;returns&gt;&lt;/returns&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;remarks&gt;&lt;/remarks&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;Property&nbsp;Caller&nbsp;As&nbsp;Form&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;summary&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;Label&nbsp;to&nbsp;show&nbsp;status&nbsp;<span class="js__statement">while</span>&nbsp;running&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;/summary&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;value&gt;&lt;/value&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;returns&gt;&lt;/returns&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;remarks&gt;&lt;/remarks&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;Property&nbsp;Label&nbsp;As&nbsp;Label&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;Sub&nbsp;New()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataTable&nbsp;=&nbsp;New&nbsp;DataTable&nbsp;With&nbsp;<span class="js__brace">{</span>.TableName&nbsp;=&nbsp;<span class="js__string">&quot;Customers&quot;</span><span class="js__brace">}</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataTable.Columns.Add(New&nbsp;DataColumn&nbsp;With&nbsp;<span class="js__brace">{</span>.ColumnName&nbsp;=&nbsp;<span class="js__string">&quot;Identifier&quot;</span>,&nbsp;.DataType&nbsp;=&nbsp;GetType(Int32)<span class="js__brace">}</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataTable.Columns.Add(New&nbsp;DataColumn&nbsp;With&nbsp;<span class="js__brace">{</span>.ColumnName&nbsp;=&nbsp;<span class="js__string">&quot;CompanyName&quot;</span>,&nbsp;.DataType&nbsp;=&nbsp;GetType(<span class="js__object">String</span>)<span class="js__brace">}</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataTable.Columns.Add(New&nbsp;DataColumn&nbsp;With&nbsp;<span class="js__brace">{</span>.ColumnName&nbsp;=&nbsp;<span class="js__string">&quot;ContactName&quot;</span>,&nbsp;.DataType&nbsp;=&nbsp;GetType(<span class="js__object">String</span>)<span class="js__brace">}</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataTable.Columns.Add(New&nbsp;DataColumn&nbsp;With&nbsp;<span class="js__brace">{</span>.ColumnName&nbsp;=&nbsp;<span class="js__string">&quot;ContactTitle&quot;</span>,&nbsp;.DataType&nbsp;=&nbsp;GetType(<span class="js__object">String</span>)<span class="js__brace">}</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataTable.Columns.Add(New&nbsp;DataColumn&nbsp;With&nbsp;<span class="js__brace">{</span>.ColumnName&nbsp;=&nbsp;<span class="js__string">&quot;Country&quot;</span>,&nbsp;.DataType&nbsp;=&nbsp;GetType(<span class="js__object">String</span>)<span class="js__brace">}</span>)&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Builder.Provider&nbsp;=&nbsp;<span class="js__string">&quot;Microsoft.ACE.OLEDB.12.0&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Builder.DataSource&nbsp;=&nbsp;IO.Path.Combine(AppDomain.CurrentDomain.BaseDirectory,&nbsp;<span class="js__string">&quot;Customers.accdb&quot;</span>)&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetRecordCount()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Sub&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;summary&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;Code&nbsp;to&nbsp;get&nbsp;data&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;/summary&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;param&nbsp;name=<span class="js__string">&quot;ct&quot;</span>&gt;&lt;/param&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;returns&gt;&lt;/returns&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;remarks&gt;&lt;/remarks&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;Async&nbsp;<span class="js__object">Function</span>&nbsp;GetDataAsync(ByVal&nbsp;ct&nbsp;As&nbsp;CancellationToken)&nbsp;As&nbsp;Task&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;CurrentRecord&nbsp;As&nbsp;Integer&nbsp;=&nbsp;<span class="js__num">1</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using&nbsp;cn&nbsp;As&nbsp;New&nbsp;OleDbConnection(Builder.ConnectionString)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using&nbsp;cmd&nbsp;As&nbsp;New&nbsp;OleDbCommand(&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">&quot;SELECT&nbsp;Identifier,&nbsp;CompanyName,&nbsp;ContactName,&nbsp;ContactTitle,&nbsp;Country&nbsp;FROM&nbsp;Customers&quot;</span>,&nbsp;cn)&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Await&nbsp;cn.OpenAsync()&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using&nbsp;reader&nbsp;As&nbsp;DbDataReader&nbsp;=&nbsp;Await&nbsp;cmd.ExecuteReaderAsync()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Do&nbsp;While&nbsp;Await&nbsp;reader.ReadAsync()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;ct.IsCancellationRequested&nbsp;Then&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exit&nbsp;Do&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;If&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;PrimaryKey&nbsp;As&nbsp;Integer&nbsp;=&nbsp;Await&nbsp;reader.GetFieldValueAsync(Of&nbsp;Integer)(<span class="js__num">0</span>)&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;ItemArray()&nbsp;As&nbsp;<span class="js__object">Object</span>&nbsp;=&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PrimaryKey,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Await&nbsp;reader.GetFieldValueAsync(Of&nbsp;<span class="js__object">String</span>)(<span class="js__num">1</span>),&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Await&nbsp;reader.GetFieldValueAsync(Of&nbsp;<span class="js__object">String</span>)(<span class="js__num">2</span>),&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Await&nbsp;reader.GetFieldValueAsync(Of&nbsp;<span class="js__object">String</span>)(<span class="js__num">3</span>),&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Await&nbsp;reader.GetFieldValueAsync(Of&nbsp;<span class="js__object">String</span>)(<span class="js__num">4</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Caller.Invoke(&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;New&nbsp;EventHandler(&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sub(sender&nbsp;As&nbsp;<span class="js__object">Object</span>,&nbsp;e&nbsp;As&nbsp;EventArgs)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataTable.Rows.Add(ItemArray)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;Label&nbsp;IsNot&nbsp;Nothing&nbsp;Then&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;Not&nbsp;Label.InvokeRequired&nbsp;Then&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Label.Text&nbsp;=&nbsp;<span class="js__object">String</span>.Format(<span class="js__string">&quot;{0}&nbsp;of&nbsp;{1}&quot;</span>,&nbsp;CurrentRecord,&nbsp;Me.RecordCount)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;If&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;If&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Sub),&nbsp;New&nbsp;<span class="js__object">Object</span>(<span class="js__num">1</span>)&nbsp;<span class="js__brace">{</span>ItemArray,&nbsp;Nothing<span class="js__brace">}</span>)&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentRecord&nbsp;&#43;=&nbsp;<span class="js__num">1</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;Beings&nbsp;we&nbsp;only&nbsp;have&nbsp;a&nbsp;small&nbsp;set&nbsp;of&nbsp;records&nbsp;we&nbsp;will&nbsp;<span class="js__statement">do</span>&nbsp;a&nbsp;delay&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thread.Sleep(<span class="js__num">1000</span>)&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Loop&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Using&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Using&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Using&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;<span class="js__object">Function</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;summary&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;Get&nbsp;record&nbsp;count&nbsp;<span class="js__operator">in</span>&nbsp;Customers&nbsp;table&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;/summary&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">''</span>'&nbsp;&lt;remarks&gt;&lt;/remarks&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Private&nbsp;Sub&nbsp;GetRecordCount()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using&nbsp;cn&nbsp;As&nbsp;New&nbsp;OleDbConnection(Builder.ConnectionString)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using&nbsp;cmd&nbsp;As&nbsp;New&nbsp;OleDbCommand(<span class="js__string">&quot;SELECT&nbsp;Count(Identifier)&nbsp;FROM&nbsp;Customers;&quot;</span>,&nbsp;cn)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cn.Open()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RecordCount&nbsp;=&nbsp;CInt(Fix(cmd.ExecuteScalar()))&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Using&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Using&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Sub&nbsp;
End&nbsp;Class&nbsp;
</pre>
</div>
</div>
</div>
<p><img id="122379" src="description/SPM.png" alt="" width="534" height="259"><br>
<br>
<span style="font-size:small"><strong>Update 8/7/2014</strong>, noticed that between projects I was not consistent with some variable names, fixed.</span></p>
<p><span style="font-size:small"><strong>Update 8/12/2014</strong>, original solution had all data operations in a class project done in C# and have added a VB.NET version.</span></p>
<p><span style="font-size:small"><img id="123691" src="description/PM.png" alt="" width="296" height="280"><br>
</span></p>
<h1>More Information</h1>
<p><span style="font-size:small">More demos will be added as time permits</span></p>

</div>


    </div>
</body>
</html>
