<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Header,0:HeaderFooterSprite,0:Header.NonMtps;/Areas/Centers/Themes/StandardDevCenter/Content:0&amp;amp;v=0F22413366F5977978C46D94D86B40A8" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Footer,0:HeaderFooterSprite,0:Footer.NonMtps,1:NewFooterSock,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;v=BA54336BC791F42AE754C419920C1AAE" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Microsoft Visual Studio Connection Dialog at runtime create database and more</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="https://i1.code.msdn.s-msft.com/content/common/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="https://i1.code.msdn.s-msft.com/content/common/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Microsoft Visual Studio Connection Dialog at runtime create database and more</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            SQL Server, Data Access, VB.Net, Object Oriented Programming
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            SQL Server, Wizard, Database Connectivity
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop, Data
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">6/16/2017</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MIT</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="https://code.msdn.microsoft.com/Visual-Studio-Connection-ebc7c67f">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Description</h1>
<p><span style="font-size:small">This code sample is about using Microsoft&rsquo;s data connection dialog which is used inside of Visual Studio when creating strong typed classes to represent data from a database. The focus here is to create a SQL-Server database,
 create two tables and populate the two tables.</span></p>
<p><br>
<span style="font-size:small">How I demonstrate the above is via a Windows forms project. There is one button, press the button which in turn displays the data connection dialog which defaults to SQL-Server which is done by placing an XML file into the bin\Debug
 folder named DataConnection.xml which you can remove from the folder which will then show all data providers rather than defaulting to SQL-Server. In the data connection dialog, there is a database selection combo box which is not used for this demonstration.
 You could disable it by downloading my <a href="https://code.msdn.microsoft.com/Visual-Studio-Connection-ebc7c67f/https://code.msdn.microsoft.com/Using-Visual-Studio-a7e740f8">
C# code sample</a> if you are comfortable with C#.</span></p>
<p><span style="font-size:small"><img id="174526" src="description/45.jpg" alt="" width="564" height="628"><br>
</span></p>
<p><br>
<span style="font-size:small">Let&rsquo;s walk through high level the process.</span></p>
<p><br>
<span style="font-size:small">When pressing the sole button on the form, there is logic to see if a setting has a value e.g. My.Settings.DatabaseConnectionString, by default it&rsquo;s empty which takes us into logic to first display the data connection dialog
 to learn their SQL-Server instance name. If they selection one we move on to creating. If the process fails e.g. SQL-Server is not installed or configured right or some other issue they can press the cancel button and everything stops here.</span></p>
<p><br>
<span style="font-size:small">Continuing with the creation process, the information obtained from the data connection dialog is used to first create our database, if that is successful we continue with creating tables.</span></p>
<p><br>
<span style="font-size:small">If the tables are created successfully then they are populated with data.</span></p>
<p><br>
<span style="font-size:small">When all goes as planned next time the app runs the button is not shown and the data we generated is displayed.</span><br>
<span style="font-size:small">Now most apps are not that simple e.g. display raw data. I kept it simple to keep the focus on using the data connection dialog rather than how code flows afterwards.</span></p>
<p>&nbsp;</p>
<p><span style="font-size:small"><strong>IMPORTANT</strong>:</span></p>
<p><span style="font-size:small">To use the data connection dialog in your project, copy the DLL files from the following folder and place into your project.</span></p>
<p><span style="font-size:small"><img id="174525" src="description/52.jpg" alt="" width="348" height="126"></span></p>
<p><strong>NOTES</strong></p>
<p><span style="font-size:small">There are comments sprinked within Operations.vb class, read them for high level reasoning and possible things to make the code your own.</span>&nbsp;</p>
<p>&nbsp;</p>
<h1>Copy rights</h1>
<p><span style="font-size:small">The data connection dialogs are not mine but Microsoft so you need to respect this.</span></p>

</div>


    </div>
</body>
</html>
